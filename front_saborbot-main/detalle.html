<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle Receta</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="js/auth.js"></script>
  <script src="js/api.js"></script>
</head>
<body class="container py-5">
  <a href="chat.html" class="btn btn-secondary mb-3">â¬… Volver</a>
  <h2 id="titulo"></h2>
  <img id="imagen" class="img-fluid my-3 border rounded" style="max-width:400px; display:none;" />
  <h4>Instrucciones</h4>
  <p id="instrucciones"></p>

  <script>
    async function cargarDetalle() {
      const params = new URLSearchParams(window.location.search);
      const id = parseInt(params.get("id"));

      // obtenemos todas las recetas del usuario
      const recetas = await apiFetch("/recetasbyuser");
      const receta = recetas.find(r => r.id === id);

      if (!receta) {
        document.body.innerHTML = "<div class='alert alert-danger'>Receta no encontrada</div>";
        return;
      }

      document.getElementById("titulo").innerText = receta.titulo;
      document.getElementById("instrucciones").innerText = receta.instrucciones;
      
      if (receta.imagen_receta_base64) {
        document.getElementById("imagen").src = `data:image/png;base64,${receta.imagen_receta_base64}`;
        document.getElementById("imagen").style.display = "block";
      }
    }
    cargarDetalle();
  </script>
</body>
</html>
